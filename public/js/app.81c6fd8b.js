(function(e){function t(t){for(var n,i,o=t[0],c=t[1],u=t[2],l=0,m=[];l<o.length;l++)i=o[l],s[i]&&m.push(s[i][0]),s[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);d&&d(t);while(m.length)m.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==s[c]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},s={app:0},a=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=c;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var n=r("64a9"),s=r.n(n);s.a},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[r("h1",[e._v("Chatroom")]),0==e.state?r("div",[r("h3",[e._v("Bienvenue dans le Chat #1! Choisissez un nom d'utilisateur")]),r("form",{on:{submit:function(t){return t.preventDefault(),e.setUsername(t)}}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.username,expression:"username"}],attrs:{type:"text",placeholder:"Username..."},domProps:{value:e.username},on:{input:function(t){t.target.composing||(e.username=t.target.value)}}}),r("input",{attrs:{type:"submit",value:"Join"}})]),r("button",{on:{click:e.continueWithoutUsername}},[e._v("Rejoindre en temps qu'invitÃ©")])]):e._e(),1==e.state?r("div",[r("ul",{attrs:{id:"chatbox"}},e._l(e.messages,function(t,n){return r("li",{key:"message-"+n},["text"===t.type?r("div",{staticClass:"message"},[r("b",[e._v(e._s(t.username))]),e._v(": "+e._s(t.text)+"\n        ")]):"audio"===t.type?r("div",{staticClass:"audio"},[r("audio",{attrs:{src:t.src,controls:""}})]):"video"===t.type?r("div",{staticClass:"video"},[r("video",{attrs:{src:t.src,controls:""}})]):"image"===t.type?r("div",{staticClass:"image"},[r("img",{attrs:{src:t.src}})]):r("div",{staticClass:"file"},[r("a",{attrs:{href:t.src,target:"_blank"}},[e._v(e._s(t.name))])])])}),0),r("form",{on:{submit:function(t){return t.preventDefault(),e.sendMessage(t)}}},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],attrs:{type:"text",placeholder:"Message..."},domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}}),e.recording?r("button",{attrs:{type:"button"},on:{click:e.stopRecord}},[r("i",{staticClass:"material-icons"},[e._v("mic_off")])]):r("button",{attrs:{type:"button"},on:{click:e.record}},[r("i",{staticClass:"material-icons"},[e._v("mic")])]),r("button",{attrs:{type:"button"},on:{click:function(t){return e.$refs.attach_file.click()}}},[r("i",{staticClass:"material-icons"},[e._v("attach_file")])]),r("input",{ref:"attach_file",staticStyle:{display:"none"},attrs:{type:"file"},on:{change:e.sendFile}}),r("input",{attrs:{type:"submit",value:"Envoyer"}})])]):e._e()])},a=[],i=(r("96cf"),r("3b8d")),o=(r("7f7f"),r("28a5"),r("8aa5")),c={apiKey:"AIzaSyDqeKQLwLppTbTIosIpKUlG1ZgHcTr9TBo",authDomain:"chatroom-8071e.firebaseapp.com",databaseURL:"https://chatroom-8071e.firebaseio.com",projectId:"chatroom-8071e",storageBucket:"chatroom-8071e.appspot.com",messagingSenderId:"209996870682"};o["initializeApp"](c);var u={name:"app",data:function(){return{message:"",messages:[],username:"",recording:!1,state:0}},methods:{sendMessage:function(){var e={id:o["firestore"]().collection("messages").doc().id,username:this.username,text:this.message,date:o["firestore"].FieldValue.serverTimestamp(),type:"text"};o["firestore"]().collection("messages").doc(e.id).set(e),this.message=""},setUsername:function(){var e=this;this.state=1,o["firestore"]().collection("messages").orderBy("date","asc").onSnapshot(function(t){e.messages=t.docs.map(function(e){return e.data()})})},continueWithoutUsername:function(){this.state=1},sendFile:function(e){var t=this,r=e.target.files[0];if(r){var n=r.type.split("/"),s=o["firestore"]().collection("messages").doc().id;o["storage"]().ref("files/"+s+"."+n[1]).put(r).then(function(e){return e.ref.getDownloadURL()}).then(function(e){var s={id:o["firestore"]().collection("messages").doc().id,username:t.username,src:e,date:o["firestore"].FieldValue.serverTimestamp(),type:n[0],name:r.name};o["firestore"]().collection("messages").doc(s.id).set(s)})}},stopRecord:function(){this.mediaRecorder.stop(),clearTimeout(this.recordTO)},record:function(){var e=Object(i["a"])(regeneratorRuntime.mark(function e(){var t,r,n=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.recording=!0,e.next=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:t=e.sent,this.mediaRecorder=new MediaRecorder(t,{mimeType:"audio/webm"}),this.recordTO=setTimeout(this.stopRecord,3e4),this.mediaRecorder.start(),r=[],this.mediaRecorder.addEventListener("dataavailable",function(e){r.push(e.data)}),this.mediaRecorder.addEventListener("stop",Object(i["a"])(regeneratorRuntime.mark(function e(){var t,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:n.recording=!1,t=new Blob(r),s=o["firestore"]().collection("messages").doc().id,o["storage"]().ref("files/"+s+".webm").put(t).then(function(e){return e.ref.getDownloadURL()}).then(function(e){var t={id:o["firestore"]().collection("messages").doc().id,username:n.username,src:e,date:o["firestore"].FieldValue.serverTimestamp(),type:"audio"};o["firestore"]().collection("messages").doc(t.id).set(t)});case 4:case"end":return e.stop()}},e)})));case 10:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()},mounted:function(){}},d=u,l=(r("034f"),r("2877")),m=Object(l["a"])(d,s,a,!1,null,null,null),p=m.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(p)}}).$mount("#app")},"64a9":function(e,t,r){}});
//# sourceMappingURL=app.81c6fd8b.js.map